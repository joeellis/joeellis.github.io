<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width initial-scale=1"> <title>Creating IEx shells on Remote Nodes | joeellis.la</title> <meta property="og:title" content="Creating IEx shells on Remote Nodes"/> <meta name="author" content="Joe Ellis"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="Learn how to connect to a running Elixir or Erlang application with IEx from the command line."/> <meta property="og:description" content="Learn how to connect to a running Elixir or Erlang application with IEx from the command line."/> <link rel="canonical" href="http://joeellis.la/iex-remsh-shells/"/> <meta property="og:url" content="http://joeellis.la/iex-remsh-shells/"/> <meta property="og:site_name" content="joeellis.la"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2017-06-10T00:00:00-05:00"/> <meta name="twitter:card" content="summary"/> <meta name="twitter:site" content="@notjoellis"/> <meta name="twitter:creator" content="@Joe Ellis"/> <script type="application/ld+json">
{"@context":"http://schema.org","@type":"BlogPosting","headline":"Creating IEx shells on Remote Nodes","author":{"@type":"Person","name":"Joe Ellis"},"datePublished":"2017-06-10T00:00:00-05:00","dateModified":"2017-06-10T00:00:00-05:00","description":"Learn how to connect to a running Elixir or Erlang application with IEx from the command line.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://joeellis.la/assets/img/avatar.png"},"name":"Joe Ellis"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://joeellis.la/iex-remsh-shells/"},"url":"http://joeellis.la/iex-remsh-shells/"}</script> <link rel="stylesheet" href="/css/main.css"> <link rel="alternate" type="application/atom+xml" title="joeellis.la" href="http://joeellis.la/feed.xml"/> <link rel="canonical" href="http://joeellis.la/iex-remsh-shells/"> <meta content="Learn how to connect to a running Elixir or Erlang application with IEx from the command line." property="description"> <meta property="og:image" content="http://joeellis.la/assets/img/avatar.png"> <meta property="article:section" content="elixir"> <meta name="twitter:title" content="Creating IEx shells on Remote Nodes"> <meta name="twitter:description" content="Learn how to connect to a running Elixir or Erlang application with IEx from the command line."> <meta name="twitter:image" content="http://joeellis.la/assets/img/avatar.png"> </head> <body> <div class="header-container"> <nav class="site-nav"> <div class="trigger"> <a class="page-link" href="/about/">About</a> <a class="page-link" href="/feed.xml">RSS</a> </div> </nav> </div> <div class="wrapper"> <div class="page-content"> <div class="header-intro"> <div class="intro-details"> <div class="intro-photo"> <a href="http://joeellis.la"> <img class="avatar-photo" src="/assets/images/avatar.png" width="55" height="55"/> </a> </div> <p class="intro-description"> <a href="http://joeellis.la">My name is Joe Ellis and I am a full stack developer in New Orleans, interested all things Elixir, Ruby, and Javascript.</a> </p> </div> </div> <hr/> <div class="post"> <header class="post-header"> <h1 class="post-title">Creating IEx shells on Remote Nodes</h1> <p class="post-meta">June 10, 2017</p> </header> <article class="post-content"> <p><strong>Note</strong>: <code class="highlighter-rouge">--remsh</code> has some security issues you should be aware of when using it on your local machine. Please be sure to read the <strong>security section</strong> at the bottom of this article.</p> <p>Recently I learned about a fun option in IEx called <code class="highlighter-rouge">--remsh</code> or “remote shell”. It starts an IEx shell within the context of a running Elixir node and also connects to that node’s cluster, allowing you to debug and reproduce issues within a running application! Also note that despite the name, <code class="highlighter-rouge">--remsh</code> can connect to both local and remote nodes.</p> <p><code class="highlighter-rouge">--remsh</code> works in combination with two options, <code class="highlighter-rouge">--name</code> and <code class="highlighter-rouge">--cookie</code>. The first option creates a named IEx shell to identify yourself to other running nodes, and the second option is <a href="http://erlang.org/doc/reference_manual/distributed.html#id88372">the security cookie</a> needed to access the node (often found under your home directory at <code class="highlighter-rouge">~/.erlang.cookie</code>).</p> <p>To create a remote shell, run IEx like this:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="c"># when running Elixir app on a server called example.com...</span>
<span class="gp">&gt; </span>iex --name <span class="s2">"joe@iex_test"</span> --cookie secret_cookie --remsh <span class="s2">"node@example.com"</span>

iex<span class="o">(</span>node@example.com<span class="o">)</span>1&gt;</code></pre></figure> <p>And you’re in! You can see your named shell by running <code class="highlighter-rouge">Node.list</code>:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="gp">iex(node@example.com)1&gt; </span>Node.list
<span class="o">[</span>:joe@iex_test]</code></pre></figure> <p>You could even wrap this up in a simple bash script to make it easier to use:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="k">function </span>reiex<span class="o">()</span> <span class="o">{</span>
 <span class="k">if</span> <span class="o">[</span> <span class="nv">$1</span> <span class="o">=</span> <span class="s2">"staging"</span> <span class="o">]</span>; <span class="k">then
  </span>iex --name <span class="s2">"</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">@reiex"</span> --cookie secret_cookie --remsh <span class="s2">"node@staging.example.com"</span>
 <span class="k">elif</span> <span class="o">[</span> <span class="nv">$1</span> <span class="o">=</span> <span class="s2">"prod"</span> <span class="o">]</span>; <span class="k">then
  </span>iex --name <span class="s2">"</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">@reiex"</span> --cookie secret_cookie --remsh <span class="s2">"node@prod.example.com"</span>
 <span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"Environment not found!"</span>
 <span class="k">fi</span>
<span class="o">}</span></code></pre></figure> <p>This way you can connect to a running instance anytime by doing <code class="highlighter-rouge">reiex staging</code>, etc. Very cool!</p> <h4 id="security-issues">Security Issues</h4> <p><code class="highlighter-rouge">--remsh</code> has security implications you should be aware of before using it. Remember - Elixir / Erlang nodes have complete access to all other nodes in a given cluster. So when you connect from your laptop via <code class="highlighter-rouge">--remsh</code>, other nodes in that cluster <strong>can now access and make RPC calls on your local workstation</strong>! If you connect to a compromised node from your local machine, your private files (even private SSH keys) would be up for grabs.</p> <p>If you plan to do any serious work with remsh, I recommend reading Alex Weber’s <a href="https://broot.ca/erlang-remsh-is-dangerous">writeup</a> which goes in further detail about this issue. Alex also offers us a more secure alternative: create an SSH connection to your remote machine first and <code class="highlighter-rouge">remsh</code> locally to the node from there. This can at least prevent node RPC calls from being made against your workstation as well as establish a more secure connection between your machine and the node.</p> <p>Happy <code class="highlighter-rouge">--remsh</code>-ing everyone!</p> </article> <hr> <div class="question"> <a class="twitter-follow-button" href="https://twitter.com/notjoeellis" data-show-count="true" data-size="large"> Follow @notjoeellis </a> <script type="text/javascript">window.twttr=function(t,e,r){var n,i,w=t.getElementsByTagName(e)[0];if(!t.getElementById(r))return i=t.createElement(e),i.id=r,i.src="https://platform.twitter.com/widgets.js",w.parentNode.insertBefore(i,w),window.twttr||(n={_e:[],ready:function(t){n._e.push(t)}})}(document,"script","twitter-wjs");</script> </div> </div> </div> <footer class="site-footer"> <p class="small">joeellis.la &copy; 2017</p> </footer> </div> </body> <script>!function(e,t,a,n,c,s,o){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,s=t.createElement(a),o=t.getElementsByTagName(a)[0],s.async=1,s.src=n,o.parentNode.insertBefore(s,o)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-99074897-1","auto"),ga("send","pageview");</script> </html>